<head>
  <title>social-umbrella</title>
  <link href="https://fonts.googleapis.com/icon?family=Material+Icons" rel="stylesheet">

</head>

<body>
  <div class="container">
    {{>layout}}
  </div>
</body>

<template name="layout">
  {{> yield "navbar"}}
  {{> yield "main"}}
</template>

<template name="navbar">
  <div class="navbar">
    <nav>
      <div class="nav-wrapper">
        <a href="/" class="brand-logo center">Social-umbrella</a>
        <ul class="center">
          <li>{{>loginButtons}}</li>
          {{#if currentUser}}
          <li>
            <a class="modal-trigger js-show-post-form" href="/add">Add post</a>
          </li>
          {{/if}}
        </ul>
      </div>
    </nav>
  </div>
</template>

<template name="hero">
  <br><br>
  <h1 class="header center orange-text">Welcome {{username}}!</h1>
  <div class="row center">
    <h5 class="header col s12 light">Feel free to add some posts</h5>
  </div>
  <div class="row center">
    {{#if currentUser}}
    <span>You are free to add some cool stuff</span>
    <p>...or just view some <a href="/posts">posts</a></p>
    {{else}}
    <span>Please Log in to add an post</span>
    <p>...or just view some <a href="/posts">posts</a></p>
    {{/if}}
  </div>
  <br><br>
</template>

<template name="contact">
  <div class="row">
    <div class="col s12">
      <h2 class="center">Contact us</h2>
    </div>
    <form class="col s12">
      <div class="row">
        <div class="input-field col s6">
          <input id="first_name" type="text" class="validate">
          <label for="first_name">First Name</label>
        </div>
        <div class="input-field col s6">
          <input id="last_name" type="text" class="validate">
          <label for="last_name">Last Name</label>
        </div>
      </div>
      <div class="row">
        <div class="input-field col s12">
          <input id="password" type="password" class="validate">
          <label for="password">Password</label>
        </div>
      </div>
      <div class="row">
        <div class="input-field col s12">
          <input id="email" type="email" class="validate">
          <label for="email">Email</label>
        </div>
      </div>
      <div class="row">
        <div class="col s12 center">
          <input type="submit" value="Send" class="btn-flat">
        </div>
      </div>
    </form>
  </div>
</template>

<template name="addPostPage">
  <div id="addPostPage">
    <div class="row">
        <div class="col s12">
          <h4>Post something</h4>
          <p>Add the url and some description</p>
        </div>
        <form class="col s12 js-add-post">
          <div class="row">
            <div class="input-field col s6">
              <input name="source" type="text" class="validate">
              <label for="first_name">Url:</label>
            </div>
            <div class="input-field col s6">
              <input name="description" type="text" class="validate">
              <label for="last_name">Short description:</label>
            </div>
          </div>
          <div class="col s12">
            <input type="submit" value="Save" class="modal-action modal-close btn-flat waves-effect">
          </div>
        </form>
      </div>
    </div>
</template>
<!-- end post add form -->

<template name="posts">
  <div class="container">
    <div class="row">
      <div class="col s12 center">
        {{#if filtering_posts}}
          <p>Showing content by user {{currentUserFilter}}.</p>
          <a href="#" class="js-unset-post-filter btn btn-primary">Remove filter</a>
        {{/if}}
      </div>
    </div>
    <div class="row">
      <div class="col s12">
        {{> EasySearch.Input index=postsIndex}}
      </div>
    </div>
    <div class="row">
      <ul class="collection col s12">
      <!-- {{#each posts}} -->
      {{#EasySearch.Each index=postsIndex}}
          <li class="collection-item avatar" id="{{_id}}">
            <a href="{{source}}" target="_blank"><i class="material-icons circle cyan darken-1">public</i></a>
            <span class="title">{{description}}<a href="/post/{{_id}}"></a></span>
            <p>
              <a href="#" class="js-set-post-filter"> {{getUser(addedBy)}}</a>
            </p>
            <p>{{formatDate addedOn}} </p>
            <p>Upvotes: {{ upvotes }} | Downvotes: {{ downvotes}}</p>
            <p>
              <span class="btn upvote {{active}}"><i class="material-icons">arrow_upward</i></span>
              <span class="btn downvote {{active}}"><i class="material-icons">arrow_downward</i></span>
            </p>
            <a href="/post/{{_id}}" class="secondary-content"><i class="material-icons">send</i></a>
          </li>
      {{/EasySearch.Each}}
      </ul>
      {{> EasySearch.LoadMore index=postsIndex}}

      {{#EasySearch.IfNoResults index=postsIndex}}
    <div class="no-results">No results found!</div>
  {{/EasySearch.IfNoResults}}
    </div> <!-- / row -->
  </div>
</template>

<template name="post">
  <div class="container" id="{{_id}}">
    <div class="row">
      <div class="col s12">
        <div class="card center">
          <div class="card-image waves-effect waves-block waves-light">
            <p><a target="_blank" href="{{source}}">{{source}} </a></p>
          </div>
          <div class="card-content">
            <span class="card-title activator grey-text text-darken-4"><i class="material-icons right">more_vert</i></span>
            <br>
            <p>
              <a href="#" class="btn upvote {{active}}"><i class="material-icons">arrow_upward</i></a>
              <a href="#" class="btn downvote {{active}}"><i class="material-icons">arrow_downward</i></a>
            </p>
            <br>
            <p>Upvotes: {{upvotes}} | Downvotes: {{downvotes}}</p>
            <p><a href="#" class="btn-flat js-set-post-filter"> {{getUser(addedBy)}}</a></p>
            <p><a class="btn-flat" href="/posts">Back to posts</a></p>
          </div>
          <div class="card-reveal">
            <span class="card-title grey-text text-darken-4">{{description}}<i class="material-icons right">close</i></span>
            <p>Here is some more information about this product that is only revealed once clicked on.</p>
            <p><a href="#">{{formatDate addedOn}}</a></p>
            <p><a href="#" class="btn js-del-post">Delete this post</a></p>
            <p>Upvotes: {{upvotes}} | Downvotes: {{downvotes}}</p>
          </div>
        </div>

        <ul class="collection with-header">
          <li class="collection-header"><h6>Comments:</h6></li>
          {{#each comment in comments}}
          <li class="collection-item">
            {{comment.commentAuthor}} says:
              <br>
            <em>{{comment.commentBody}}</em>
            <br>
            <small>Posted on: <date>{{formatDate comment.commentDate}}</date></small>
          </li>
          {{/each}}
        </ul>
        <h5 class="center">You can also leave a comment!</h5>

        <form class="col s6 offset-s3" id="add_comment_form">
          <div class="row">
            <div class="input-field col s12">
              <textarea id="commentBody" class="materialize-textarea"></textarea>
              <label for="commentBody">Comment</label>
            </div>
          </div>
          <input type="submit" class="btn btn-flat js-add-comment" value="Add comment">
        </form>
      </div>
    </div>
  </div>
</template>
